# 在虚拟化环境下给黑群晖 7.x 版本扩容磁盘容量的方法

如果是物理裸机部署群晖的情况下基本不存在这种问题。

在虚拟化化境包括 ESXi，hyper-V，PVE 等虚拟化环境，给黑群晖挂载了虚拟磁盘，随着时间的使用磁盘的空间容量逐渐不够，需要扩容磁盘，此时有第二种方案。

## 第一种

第一种方案：如果“存储池”中的 raid 类型为 JBOD 模式的情况，可以在虚拟化环境下直接再挂载一个磁盘，然后再存储池中添加磁盘即可，下面是 JBOD 在知乎中的解释：

JBOD（Just a bunch of disk）严格上来说不是一种 RAID，因为它只是简单将多个磁盘合并成一个大的逻辑盘，并没有任何的数据冗余。数据的存放机制就是从第一块磁盘开始依序向后存储数据。如果某个磁盘损毁，则该盘上的数据就会丢失。

## 第二种

第二种方案：可以在虚拟化环境中直接扩容原有的磁盘大小（只能扩大不能缩小）不同的虚拟化环境操作略微不同，扩容完成之后群晖并不能直接认出扩容的空间，重启也不行，此事需要 ssh 登录群晖进行操作。网上有群晖 6.X 版本的操作知道，7.x 版本也类似，但是由于磁盘的命名发生变化，所以写出来供大家参考。

1. 开始群晖的 ssh 登录的功能，不会的自行百度
2. 使用 ssh 工具登录群晖，用户名就是 web 的管理员账户，密码就是 web 登录的密码
3. 提权 sudo -i 密码也是 web 登录的密码
4. 查看磁盘的文件

![upload_15p93nh36dsyjhkfx6ornz5c1n9lxhlj.png](https://cdn.mo0.top/2024/01/21/upload_15p93nh36dsyjhkfx6ornz5c1n9lxhlj.png)

**在虚拟化环境下给黑群晖 7.x 版本扩容磁盘容量的方法这时候可以参考虚拟化中，磁盘在 SCSI 或者 SATA 控制器下的通道号：**  
**在虚拟化环境下给黑群晖 7.x 版本扩容磁盘容量的方法**
我扩容的磁盘为 SATA(0:1)，所以在 命名文件为、/dev/sata1p2 我扩容的磁盘为 SATA(0:4)，所以在 命名文件为、/dev/sata1p2  
按照我的理解 SATAX 代表磁盘编号，pY 代表分区号。这里的命名方式是和 6.x 版本的有区别。然后运行命令

```shell
parted /dev/sata1 resizepart 3 100%
```

完成之后可以不用理会 information 的提示，在群晖 web 界面中重新启动。然后登录打开存储管理器，由于我操作完成没有截图，所以借用了网上的一张图片。点击立即扩容，完成操作。

在虚拟化环境下给黑群晖 7.x 版本扩容磁盘容量的方法
如果有什么写的不对的地方，希望大家指正，同时硬盘操作属于高危操作，希望大家在保证数据安全的情况下进行操作，数据无价！！！
